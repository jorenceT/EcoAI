
(defrule
(unit-type-count-total villager > 9)
(unit-type-count-total villager < 14)
(food-amount > 65)
(up-pending-objects c:< villager > 0)
(dropsite-min-distance boar-hunting < 7)
=>
(set-strategic-number sn-enable-boar-hunting 2)
(set-strategic-number sn-minimum-number-hunters 5)
(set-strategic-number sn-minimum-boar-hunt-group-size 5)
)


(defrule
(unit-type-count-total villager > 9)
(unit-type-count-total villager < 14)
(food-amount > 65)
(up-pending-objects c:< villager > 0)
(dropsite-min-distance boar-hunting > 6)
=>
(set-strategic-number sn-enable-boar-hunting 2)
(set-strategic-number sn-minimum-number-hunters 1)
(set-strategic-number sn-minimum-boar-hunt-group-size 1)
)

(defrule
(unit-type-count-total villager > 14)
(unit-type-count-total villager < 19)
(food-amount > 65)
(up-pending-objects c:< villager > 0)
(dropsite-min-distance boar-hunting < 9)
=>
(set-strategic-number sn-minimum-number-hunters 7)
(set-strategic-number sn-enable-boar-hunting 2)
(set-strategic-number sn-minimum-boar-hunt-group-size 7)
)

(defrule
(unit-type-count-total villager > 14)
(unit-type-count-total villager < 21)
(food-amount > 65)
(up-pending-objects c:< villager > 0)
(dropsite-min-distance boar-hunting > 8)
=>
(set-strategic-number sn-minimum-number-hunters 2)
(set-strategic-number sn-enable-boar-hunting 2)
(set-strategic-number sn-minimum-boar-hunt-group-size 2)
)


(defrule
(unit-type-count-total villager > 21)
=>
(set-strategic-number sn-enable-boar-hunting 1)
(set-strategic-number sn-minimum-number-hunters 0)
)

(defrule
(game-time < 300)
=>
(set-strategic-number sn-food-gatherer-percentage 90)
(set-strategic-number sn-wood-gatherer-percentage 10)
(set-strategic-number sn-percent-building-cancellation 40)
(set-strategic-number sn-enable-new-building-system 1)
(set-strategic-number sn-maximum-town-size 14)
(set-strategic-number sn-sentry-distance 0)
(disable-self)
)

(defrule
(true)
=>
(set-strategic-number sn-food-dropsite-distance 26)
 (set-strategic-number sn-wood-dropsite-distance 27)
 (set-strategic-number sn-stone-dropsite-distance 22)
 (set-strategic-number sn-gold-dropsite-distance 19)
(set-difficulty-parameter ability-to-maintain-distance 40)
(set-strategic-number sn-maximum-food-drop-distance 15)
(set-difficulty-parameter ability-to-dodge-missiles 0) 
(set-strategic-number sn-initial-exploration-required 1)
(set-strategic-number sn-camp-max-distance 18)
(set-strategic-number sn-task-ungrouped-soldiers 1)
(set-strategic-number sn-maximum-hunt-drop-distance 40);block villies hunting deer so far away
(set-strategic-number sn-task-ungrouped-soldiers 0)
(generate-random-number 2)
(disable-self)
)

(defrule
(game-time > 25)
=>
(set-strategic-number sn-minimum-civilian-explorers 0)
(set-strategic-number sn-cap-civilian-explorers 0)
(set-strategic-number sn-total-number-explorers 1)
(set-strategic-number sn-number-explore-groups 1)
(set-strategic-number sn-initial-exploration-required 1)
(set-strategic-number sn-percent-civilian-gatherers 0)
(set-strategic-number sn-percent-civilian-explorers 0)
(set-strategic-number sn-percent-civilian-builders 100)
(set-strategic-number sn-cap-civilian-builders 9001)
)

(defrule
(game-time < 25)
=>
(set-strategic-number sn-minimum-civilian-explorers 2)
(set-strategic-number sn-cap-civilian-explorers 2)
(set-strategic-number sn-total-number-explorers 4)
(set-strategic-number sn-number-explore-groups 3)
(set-strategic-number sn-initial-exploration-required 1)
(set-strategic-number sn-percent-civilian-gatherers 0)
(set-strategic-number sn-percent-civilian-explorers 66)
(set-strategic-number sn-percent-civilian-builders 33)
(set-strategic-number sn-home-exploration-time 475)
)

(defrule
(not(town-under-attack))
=>
(set-strategic-number sn-enemy-sighted-response-distance 5)
)

(defrule
(town-under-attack)
=>
(set-strategic-number sn-enemy-sighted-response-distance 50)
)

(defrule
(true)
=>
(set-strategic-number sn-target-evaluation-range -4000)
(set-strategic-number sn-random-placement-factor 1)
(set-strategic-number sn-target-evaluation-randomness 1)
(set-strategic-number sn-target-evaluation-rof -500)
(set-strategic-number sn-target-evaluation-hitpoints -800)
(set-strategic-number sn-target-evaluation-damage-capability -200)
(set-strategic-number sn-target-evaluation-ally-proximity 100)
(set-strategic-number sn-target-evaluation-time-kill-ratio 200)
(set-strategic-number sn-target-evaluation-in-progress 400)
(set-strategic-number sn-minimum-dropsite-buffer 100)
)


(defrule
(unit-type-count-total villager < 9)
=>
(set-strategic-number sn-food-gatherer-percentage 94)
(set-strategic-number sn-wood-gatherer-percentage 6)
(set-strategic-number sn-camp-max-distance 20)
(set-strategic-number sn-minimum-dropsite-buffer 200)
(disable-self)
)



(defrule
(current-age == dark-age)
(unit-type-count-total villager > 8)
=>
(set-strategic-number sn-food-gatherer-percentage 85)
(set-strategic-number sn-gold-gatherer-percentage 0)
(set-strategic-number sn-wood-gatherer-percentage 15)
(set-strategic-number sn-stone-gatherer-percentage 0)
;set-strategic-number sn-maximum-town-size 17)
)



(defrule
(current-age == dark-age)
(unit-type-count-total villager > 10)
=>
(set-strategic-number sn-food-gatherer-percentage 60)
(set-strategic-number sn-gold-gatherer-percentage 0)
(set-strategic-number sn-wood-gatherer-percentage 40)
(set-strategic-number sn-stone-gatherer-percentage 0)
;set-strategic-number sn-maximum-town-size 17)
)

(defrule
(unit-type-count-total villager > 14)
(current-age == dark-age)
=>
(set-strategic-number sn-food-gatherer-percentage 75)
(set-strategic-number sn-wood-gatherer-percentage 25)
)

(defrule
(unit-type-count-total villager > 24)
(current-age == dark-age)
=>
(set-strategic-number sn-food-gatherer-percentage 52)
(set-strategic-number sn-gold-gatherer-percentage 0)
(set-strategic-number sn-wood-gatherer-percentage 48)
(set-strategic-number sn-stone-gatherer-percentage 0)
)

(defrule
(unit-type-count-total villager > 26)
(current-age == dark-age)
=>
(set-strategic-number sn-food-gatherer-percentage 50)
(set-strategic-number sn-gold-gatherer-percentage 5)
(set-strategic-number sn-wood-gatherer-percentage 45)
(set-strategic-number sn-stone-gatherer-percentage 0)
(set-strategic-number sn-maximum-food-drop-distance 20)
(set-strategic-number sn-maximum-hunt-drop-distance 27)
)

(defrule
(unit-type-count-total villager > 27)
(current-age == dark-age)
=>
(set-strategic-number sn-food-gatherer-percentage 48)
(set-strategic-number sn-gold-gatherer-percentage 10)
(set-strategic-number sn-wood-gatherer-percentage 42)
(set-strategic-number sn-stone-gatherer-percentage 0)
)


(defrule
(strategic-number 88 > 1)
(current-age == dark-age)
=>
(set-strategic-number sn-food-gatherer-percentage 55)
(set-strategic-number sn-gold-gatherer-percentage 10)
(set-strategic-number sn-wood-gatherer-percentage 35)
(set-strategic-number sn-stone-gatherer-percentage 0)
(set-strategic-number sn-minimum-number-hunters 3)
)


(defrule
(current-age == feudal-age)
(building-type-count-total archery-range > 0)
=>
(set-strategic-number sn-food-gatherer-percentage 55)
(set-strategic-number sn-gold-gatherer-percentage 10)
(set-strategic-number sn-wood-gatherer-percentage 35)
(set-strategic-number sn-stone-gatherer-percentage 0)
(set-strategic-number sn-minimum-number-hunters 3)
)

(defrule
(strategic-number 88 > 2)
(current-age == feudal-age)
=>
(set-strategic-number sn-food-gatherer-percentage 30)
(set-strategic-number sn-gold-gatherer-percentage 10)
(set-strategic-number sn-wood-gatherer-percentage 55)
(set-strategic-number sn-stone-gatherer-percentage 5)
)

(defrule
(current-age == castle-age)
(building-type-count-total town-center < 4)
=>
(set-strategic-number sn-food-gatherer-percentage 35)
(set-strategic-number sn-gold-gatherer-percentage 10)
(set-strategic-number sn-wood-gatherer-percentage 50)
(set-strategic-number sn-stone-gatherer-percentage 5)
(set-strategic-number sn-camp-max-distance 40)
(set-strategic-number sn-dropsite-separation-distance 8)
)


(defrule
(current-age == castle-age)
(building-type-count-total town-center > 3)
=>
(set-strategic-number sn-food-gatherer-percentage 47)
(set-strategic-number sn-gold-gatherer-percentage 15)
(set-strategic-number sn-wood-gatherer-percentage 32)
(set-strategic-number sn-stone-gatherer-percentage 6)
(set-strategic-number sn-camp-max-distance 140)
(set-strategic-number sn-dropsite-separation-distance 8)
)


(defrule
(can-build house)
(building-type-count-total town-center > 0)
(housing-headroom < 3)
(game-time < 25)
(up-pending-objects c:< house < 2)
=>
(build house)
(up-assign-builders c:< house 2)
)

(defrule
(can-build house)
(building-type-count-total town-center > 0)
(housing-headroom < 4)
(game-time < 25)
(game-time > 3)
(up-pending-objects c:< house < 2)
=>
(build house)
(up-assign-builders c:< house 1)
)


(defrule
(can-build lumber-camp)
(resource-found wood)
(up-pending-objects c:< lumber-camp < 1)
(building-type-count-total lumber-camp < 1)
(unit-type-count villager > 6)
=>
(build lumber-camp)
)


(defrule
(can-research feudal-age)
(or(unit-type-count-total villager > 28)
(food-amount > 650))
=>
(research feudal-age)
(set-strategic-number 88 2)
)

(defrule
(can-research castle-age)
=>
(research castle-age)
(set-strategic-number 88 3)
)

(defrule
(can-research imperial-age)
=>
(research imperial-age)
(set-strategic-number 88 4)
)

(defrule
(unit-type-count villager > 34)
=>
(research ri-wheel-barrow)
)

(defrule
(unit-type-count-total villager-hunter > 0)
=>
(research ri-loom)
)


(defrule
(unit-type-count-total villager < 29)
(current-age == dark-age)
(or(food-amount < 670)
(unit-type-count-total villager < 19))
=>
(train villager)
)


(defrule
(can-build mill)
(unit-type-count-total villager-forager > 0)
(game-time > 120)
(building-type-count-total mill < 1)
=>
(build mill)
)

(defrule
(building-type-count mill < 1)
(unit-type-count-total villager-forager > 1);1 vill 3 forage is ok
=>
(set-strategic-number sn-enable-boar-hunting 1)
(up-retask-gatherers villager-forager c:< 3)
(disable-self)
)


(defrule
(building-type-count-total farm > 1)
(can-build lumber-camp)
(building-type-count-total lumber-camp < 2)
(up-pending-objects c:< lumber-camp < 1)
=>
(build lumber-camp)
)



(defrule
(building-type-count-total blacksmith > 0)
(building-type-count-total archery-range > 0)
(can-build farm)
(idle-farm-count < 2)
=>
(build farm)
)




(defrule
(building-type-count-total archery-range > 0)
(can-build blacksmith)
(building-type-count-total blacksmith < 1)
=>
(build blacksmith)
)


(defrule
(strategic-number sn-gold-gatherer-percentage > 0)
(can-build mining-camp)
(resource-found gold)
(building-type-count-total mining-camp < 1)
(up-pending-objects c:< mining-camp < 1)
=>
(build mining-camp)
)

(defrule
(building-type-count-total farm < 3)
(can-build farm)
=>
(build farm)
)

(defrule
(unit-type-count-total villager > 23)
(can-build mill)
(building-type-count-total mill < 2)
(unit-type-count-total villager-hunter > 0)
(up-pending-objects c:< mill < 1)
=>
(build mill)
)

(defrule
(building-type-count-total mill > 1)
(can-build barracks)
(building-type-count-total barracks < 1)
(up-pending-objects c:< barracks < 1)
=>
(build barracks)
)

(defrule
(can-build blacksmith)
(building-type-count-total blacksmith < 1)
(up-pending-objects c:< blacksmith < 1)
=>
(build blacksmith)
)

(defrule
(can-build archery-range)
(building-type-count-total archery-range < 1)
(up-pending-objects c:< archery-range < 1)
=>
(build archery-range)
)


(defrule
(or(and(wood-amount > 200)
(strategic-number 88 != 2))
(and(wood-amount > 380)
(strategic-number 88 == 2)))
(game-time > 400)
(current-age == dark-age)
(can-build farm)
=>
(build farm)
)

(defrule
(current-age >= castle-age)
(unit-type-count-total villager < 150)
(or(or(food-amount < 1500)
(wood-amount < 1500))
(or(gold-amount < 1500)
(game-time < 2400)))
=>
(train villager)
)

(defrule
(unit-type-count-total villager > 80)
(gold-amount > 2000)
(current-age == imperial-age)
=>
(delete-unit villager)
)


(defrule
(unit-type-count-total villager > 40)
(gold-amount > 1000)
(wood-amount > 20000)
(current-age == imperial-age)
(population > 180)
=>
(delete-unit villager)
)

(defrule
(game-time > 1800)
(players-military-population every-enemy < 10)
(players-military-population my-player-number > 30)
(resource-found gold)
(building-type-count-total mining-camp < 8)
(wood-amount > 400)
=>
(build-forward mining-camp)
(chat-to-player my-player-number "lets steal the enemys gold")
)


(defrule
(current-age == feudal-age)
(food-amount < 725)
(unit-type-count-total villager < 31)
=>
(train villager)
)


(defrule
(food-amount < 50)
(up-pending-objects c:< villager < 1)
(unit-type-count-total villager-hunter > 2)
(game-time < 1500)
=>
(up-drop-resources food c:< 8)
)



(defrule
(building-type-count-total mining-camp > 0)
(building-type-count-total mining-camp < 2)
(up-pending-objects c:< mining-camp < 1)
(can-build mining-camp)
(resource-found gold)
(dropsite-min-distance gold > 4)
(dropsite-min-distance gold < 255)
=>
(build mining-camp)
(chat-to-player my-player-number "I FRIGGIN HATE IT WHEN THIS HAPPENS")
)


(defrule
(can-build town-center)
(game-time > 1000)
(building-type-count-total town-center < 6)
(up-pending-objects c:< town-center < 5)
=>
(set-strategic-number sn-gold-defend-priority 7) ;Try to drop the tc at gold
(build town-center)
(up-assign-builders c:< town-center 8)
)





(defrule
(food-amount > 1500)
(gold-amount < 1750)
(can-sell-commodity food)
=>
(sell-commodity food)
)




(defrule
(or(or(wood-amount > 1200)
(food-amount > 2400))
(or(gold-amount > 2400)
(game-time > 4500)))
(can-build market)
(building-type-count-total market < 1)
=>
(build market)
)

(defrule
(wood-amount > 1800)
(gold-amount < 2500)
(can-sell-commodity wood)
=>
(sell-commodity wood)
)


(defrule
(wood-amount > 1000)
(gold-amount < 250)
(can-sell-commodity wood)
=>
(sell-commodity wood)
)

(defrule
(gold-amount > 1200)
(food-amount < 1000)
(can-buy-commodity food)
=>
(buy-commodity food)
(buy-commodity food)
)

(defrule
(wood-amount < 600)
(gold-amount > 1500)
(can-buy-commodity wood)
=>
(buy-commodity wood)
(buy-commodity wood)
)




(defrule
(can-build house)
(or(housing-headroom < 3)
(and(building-type-count-total archery-range > 0)
(housing-headroom < 14)))
(up-pending-objects c:< house < 1)
(building-type-count-total town-center > 0)
(game-time > 30)
=>
(build house)
)

(defrule
(can-build monastery)
(current-age >= castle-age)
(current-age-time > 600)
=>
(build monastery)
)

(defrule
(town-under-attack)
(game-time < 2100)
=>
(train spearman-line)
(train skirmisher-line)
(train my-unique-unit)
)

(defrule
(unit-type-count-total spearman-line > 1)
=>
(research ri-scale-mail)
(research ri-pikeman)
)

(defrule
(unit-type-count-total skirmisher-line > 0)
=>
(research ri-fletching)
(research ri-bodkin-arrow)
(research ri-elite-skirmisher)
)

(defrule
(town-under-attack)
(can-build watch-tower)
(up-pending-objects c:< watch-tower < 1)
(building-type-count-total watch-tower < 3)
(building-type-count-total castle < 1)
(game-time < 1600)
=>
(build watch-tower)
)

(defrule
(unit-type-count-total monk < 2)
=>
(train monk)
)

(defrule
(can-build castle)
(not(civ-selected turkish))
=>
(build castle)
)

#load-if-defined CELTIC-CIV

(defrule
(current-age == castle-age)
(current-age-time > 700)
(can-build siege-workshop)
(building-type-count-total siege-workshop < 3)
=>
(build siege-workshop)
)

(defrule
(can-build university)
(game-time > 2100)
(building-type-count-total university < 1)
=>
(build university)
)

(defrule
(strategic-number 88 > 3)
=>
(research my-unique-unit-upgrade)
(research my-unique-research)
(research ri-scale-mail)
(research ri-chain-mail)
(research ri-plate-mail)
(research ri-forging)
(research ri-iron-casting)
(research ri-blast-furnace)
(research ri-siege-engineers)
(research ri-chemistry)
(research ri-onager)
(research ri-siege-onager)
)

(defrule
(strategic-number 88 > 3)
=>
(train my-unique-unit)
(train mangonel-line)
)

#end-if
